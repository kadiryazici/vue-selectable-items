import{m as G,d as de,f as B,r as me,g as pe,h as ye,i as Ie,j as C,k as S,l as ge,F as U,a as be}from"./index.612d51d9.js";const F={Custom:Symbol(),Item:Symbol(),Group:Symbol()};var o=(t=>(t[t.Focus=0]="Focus",t[t.Unfocus=1]="Unfocus",t[t.Select=2]="Select",t[t.DOMFocus=3]="DOMFocus",t))(o||{});const T="vue-selectable-items",E={Wrapper:T,Item:`${T}-item`,Focused:`${T}-item-focused`,Disabled:`${T}-item-disabled`},y=Object.freeze(Object.create(null));function we(t){return{...t,wrapperComponentOrTag:b(t.wrapperComponentOrTag)?G(t.wrapperComponentOrTag):t.wrapperComponentOrTag,type:F.Group}}function Ce(t){return{...t,disabled:!!t.disabled,wrapperComponentOrTag:b(t.wrapperComponentOrTag)?G(t.wrapperComponentOrTag):t.wrapperComponentOrTag,type:F.Item}}function Se(t){return{...t,type:F.Custom}}const $=t=>Object.prototype.toString.call(t).slice(8,-1);function d(t){return $(t)==="Object"}function J(t){return $(t)==="String"}function j(t){return $(t)==="Function"}function Fe(t,u){return Object.prototype.hasOwnProperty.call(t,u)}function z(t){return b(t)||J(t)}function q(t){return d(t)&&t.type===F.Group}function i(t){return d(t)&&t.type===F.Item}function Q(t){return d(t)&&t.type===F.Custom}function b(t){return d(t)?j(t.setup)||j(t.render)||J(t.template):j(t)}function W(t,u=[]){return t.forEach(a=>{Array.isArray(a)&&W(a,u),q(a)&&W(a.items,u),(i(a)||Q(a))&&u.push(a)}),u}function ve(t){return W(t).filter(i)}function k(t,u,a){return u(t)?t:a}function ke(t){if(typeof t=="function")return t;const{wrapperComponentOrTag:u=null,...a}=t;return{...a,wrapperComponentOrTag:b(u)?G(u):u}}var g;(function(t){t[t.Next=0]="Next",t[t.Previous=1]="Previous"})(g||(g={}));function h(t,u){return t.find(a=>a.key===u)}const K="wrapperComponentOrTag",he=de({name:"SelectableItems",inheritAttrs:!1,props:{noWrapperElement:{type:Boolean,default:!1},items:{type:Array,default:()=>[]},setup:{type:Function,default:null},itemDefaults:{type:[Object,Function],default:null}},emits:{select:null,itemFocus:null,itemUnfocus:null,itemDOMFocus:null},setup(t,{emit:u,expose:a,slots:m,attrs:X}){var _;const c=B(()=>ve(t.items)),l=me(""),L=B(()=>c.value.findIndex(n=>n.key===l.value)),Z=B(()=>c.value[L.value]),v={[o.Focus]:new Set,[o.Select]:new Set,[o.Unfocus]:new Set,[o.DOMFocus]:new Set},H=n=>v[o.Focus].add(n),ee=n=>v[o.Select].add(n),te=n=>v[o.Unfocus].add(n),ne=n=>v[o.DOMFocus].add(n);function D(n,...e){v[n].forEach(r=>r(...e))}function re(n,e,r=!1){if((n==null?void 0:n.key)!==(e==null?void 0:e.key)){if(i(e)){const s=O(e.key);D(o.Unfocus,e.meta,e,s),u("itemUnfocus",e.meta,e,s)}if(i(n)){const s=O(n.key);D(o.Focus,n.meta,n,s,r),u("itemFocus",n.meta,n,s,r)}}}const p=(n,e=!1)=>{const r=n||"",s=h(c.value,r);if(s!=null&&s.disabled)return;const w=h(c.value,l.value);l.value=r,re(s,w,e)};pe(()=>c.value.map(n=>n.key),n=>{n.some(r=>r===l.value)||p("")});const R=n=>{const e=c.value[n];i(e)&&p(c.value[n].key)},I=ye(new Map);Ie(()=>I.clear());const se=(n,e)=>I.set(n,e),ue=(n={})=>{const e=I.get(l.value);e&&e.scrollIntoView(n)},ce=n=>{const e=c.value[n];if(i(e))return I.get(e.key)},O=n=>{const e=h(c.value,n);if(i(e))return I.get(n)},ae=n=>{p(n.key,!0)},oe=n=>{n.disabled||(l.value!==n.key?(p(n.key),setTimeout(()=>M(n.key),0)):M(n.key))},le=(n,e)=>{if(e.disabled)return;const r=O(e.key);D(o.DOMFocus,n,e.meta,e,r),u("itemDOMFocus",n,e.meta,e,r)},V=n=>{if(c.value.every(s=>s.disabled))return p("");const e=n===g.Next?1:-1;let r=L.value;for(;;)if(r+=e,n===g.Next?r>=c.value.length&&(r=0):r<0&&(r=c.value.length-1),!c.value[r].disabled)return R(r)},fe=n=>l.value===n,ie=n=>{const e=c.value.find(r=>r.key===n);return(e==null?void 0:e.disabled)===!0},M=n=>{var s;const e=h(c.value,n);if(!e||e.disabled)return;const r=O(e.key);(s=e.onSelect)==null||s.call(e,e.meta,e,r),D(o.Select,e.meta,e,r),u("select",e.meta,e,r)},Y={focusNext:()=>V(g.Next),focusPrevious:()=>V(g.Previous),clearFocus:()=>p(""),setFocusByKey:p,setFocusByIndex:R,onSelect:ee,onFocus:H,onUnfocus:te,onDOMFocus:ne,getSelectableItemCount:()=>c.value.length,selectFocusedItem:()=>M(l.value),getItemElementByIndex:ce,getItemElementByKey:O,scrollToFocusedItemElement:ue,getItemMetaByKey(n){var e;return(e=h(c.value,n))==null?void 0:e.meta},getSelectableItems(){return c.value},getFocusedItemElement:()=>I.get(l.value),getFocusedItem(){return Z.value}};a(Y),(_=t.setup)==null||_.call(t,Y);const N=n=>ge(n,e=>{var r;if(Array.isArray(e))return N(e);if(q(e)){const s=e[K]||U,w=e.wrapperProps||y,x=N(e.items);return C(s,S(w,{key:e.key}),b(s)?{default:()=>x}:x)}if(i(e)){const s=typeof t.itemDefaults=="function"?t.itemDefaults(e):t.itemDefaults||y,w=k(e.elementTag||s.elementTag,z,"div"),x=S(k(s.elementAttrs,d,y),k(e.elementAttrs,d,y)),P=be(w,S({"data-vue-selectable-items-item":"",class:[E.Item,{[E.Focused]:fe(e.key),[E.Disabled]:ie(e.key)}]},x,{onMouseenter:()=>ae(e),onFocus:f=>le(f,e),onClick:()=>oe(e),ref:f=>se(e.key,f)}),{default:()=>{var f;return[(f=m.render)==null?void 0:f.call(m,e)]}}),A=e[K]||s[K];if(z(A)){const f=S(k(s.wrapperProps,d,y),k(e.wrapperProps,d,y),{key:e.key});return C(A,f,b(A)?{default:()=>[P]}:[P])}return P}return Q(e)&&Fe(m,e.name)?C(U,{key:e.key},(r=m[e.name])==null?void 0:r.call(m,e.meta)):null});return()=>{const n=N(t.items);return t.noWrapperElement?C(U,y,n):C("div",S({class:E.Wrapper},X),n)}}});export{he as S,Se as a,we as b,ke as c,Ce as i};
