import{d as $,r as v,f as A,g as H,q as ke,n as ce,s as U,v as R,a as g,k as I,x as Ee,h as Oe,y as Se,T as J,z as Ce,A as Be,o as L,c as de,w as q,e as _e,t as Te,B as Q,u as C,C as Z,F as fe,_ as he,b as E}from"./index.612d51d9.js";import{c as Ae,S as He,i as p}from"./Component.423a7f3b.js";import{u as S}from"./useKey.0d18fc1e.js";import{I as Le}from"./chevron-right.4031f9d5.js";const Ie="wowerlay-background",We="wowerlay",Me="wowerlay-anim-enter",ze="wowerlay-anim-leave",Ve="--wowerlay-x",Ne="--wowerlay-y",W=15;var _;(function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"})(_||(_={}));const F=({targetRect:e,wowerlayRect:t},n)=>n===1?{x:0,y:e.y+e.height/2-t.height/2}:{x:e.x+e.width/2-t.width/2,y:0},G=({targetRect:e},t)=>t===1?{x:0,y:e.y}:{x:e.x,y:0},P=({targetRect:e,wowerlayRect:t},n)=>n===1?{x:0,y:e.y+e.height-t.height}:{x:e.x+e.width-t.width,y:0},M=({targetRect:e,wowerlayRect:t},{horizontalGap:n})=>({x:e.x+e.width+n,y:F({targetRect:e,wowerlayRect:t},1).y}),ee=(e,t)=>({x:M(e,t).x,y:G(e,1).y}),te=(e,t)=>({x:M(e,t).x,y:P(e,1).y}),z=({targetRect:e,wowerlayRect:t},{horizontalGap:n})=>({x:e.x-t.width-n,y:F({targetRect:e,wowerlayRect:t},1).y}),ne=(e,t)=>({x:z(e,t).x,y:G(e,1).y}),oe=(e,t)=>({x:z(e,t).x,y:P(e,1).y}),V=({targetRect:e,wowerlayRect:t},{verticalGap:n})=>({x:F({targetRect:e,wowerlayRect:t},0).x,y:e.y-t.height-n}),le=(e,t)=>({x:G(e,0).x,y:V(e,t).y}),ie=(e,t)=>({y:V(e,t).y,x:P(e,0).x}),N=({targetRect:e,wowerlayRect:t},{verticalGap:n})=>({x:F({targetRect:e,wowerlayRect:t},0).x,y:e.y+e.height+n}),ae=(e,t)=>({x:G(e,0).x,y:N(e,t).y}),se=(e,t)=>({y:N(e,t).y,x:P(e,0).x}),$e=({targetRect:e,wowerlayRect:t},{verticalGap:n})=>e.y-t.height-n<0,Fe=({targetRect:e,wowerlayRect:t},{verticalGap:n})=>e.y+e.height+t.height+W+n>window.innerHeight,Ge=({targetRect:e,wowerlayRect:t},{horizontalGap:n})=>e.x-t.width-n<0,Pe=({targetRect:e,wowerlayRect:t},{horizontalGap:n})=>e.x+e.width+t.width+W+n>window.innerWidth,X=()=>typeof window<"u"&&typeof document<"u",je=()=>X()&&"ResizeObserver"in window,k=e=>X()&&e instanceof HTMLElement;function De(e){const t=[];let n=e.parentNode;for(;n!=null;)t.push(n),n=n.parentNode;return t}const me={target:{type:Object},backgroundAttrs:{type:Object,default:()=>({})},noBackground:{default:!1,type:Boolean},fixed:{default:!1,type:Boolean},syncWidth:{default:!1,type:Boolean},syncHeight:{default:!1,type:Boolean},noFlip:{default:!1,type:Boolean},position:{default:"bottom",type:String},verticalGap:{default:0,type:Number},horizontalGap:{default:0,type:Number},canLeaveViewport:{default:!1,type:Boolean},tag:{default:"div",type:String},transition:{default:!0,type:[Boolean,String]}},re={top:{handle:V,handleOutOfScreen:N},"top-start":{handle:le,handleOutOfScreen:ae},"top-end":{handle:ie,handleOutOfScreen:se},right:{handle:M,handleOutOfScreen:z},"right-start":{handle:ee,handleOutOfScreen:ne},"right-end":{handle:te,handleOutOfScreen:oe},bottom:{handle:N,handleOutOfScreen:V},"bottom-start":{handle:ae,handleOutOfScreen:le},"bottom-end":{handle:se,handleOutOfScreen:ie},left:{handle:z,handleOutOfScreen:M},"left-start":{handle:ne,handleOutOfScreen:ee},"left-end":{handle:oe,handleOutOfScreen:te}},Ue=$({name:"WowerlayRenderer",inheritAttrs:!1,props:me,emits:{click:null,"update:el":null},setup(e,{emit:t,expose:n}){const o=v(null),a=v(0),d=v(0),f=v(null),b=v(null),s=A(()=>e.position.split("-")[0]),u=A(()=>({[Ve]:`${d.value}px`,[Ne]:`${a.value}px`})),i=A(()=>({width:f.value?`${f.value}px`:null,height:b.value?`${b.value}px`:null})),m=r=>t("click",r),c=(r,y)=>{if(e.canLeaveViewport||!o.value)return r;const{width:h,height:x}=o.value.getBoundingClientRect();if(y===_.Horizontal){const B=window.innerWidth-h-W;return Math.max(0,Math.min(B,r))}const O=window.innerHeight-x-W;return Math.max(0,Math.min(O,r))},w=()=>{if(!X()||!k(e.target)||!k(o.value))return;const r=e.target.getBoundingClientRect(),y=o.value.getBoundingClientRect(),h={targetRect:r,wowerlayRect:y},x={verticalGap:e.verticalGap,horizontalGap:e.horizontalGap},O={x:0,y:0},B=({x:xe,y:be})=>{O.x=xe,O.y=be},{checkOutOfScreen:K,handle:we,handleOutOfScreen:j}=re[e.position]||re.bottom;B(we(h,x)),j&&!e.noFlip&&(K?K(h)&&B(j(h,x)):(s.value==="top"&&$e(h,x)||s.value==="bottom"&&Fe(h,x)||s.value==="left"&&Ge(h,x)||s.value==="right"&&Pe(h,x))&&B(j(h,x))),e.syncWidth&&(f.value=r.width),e.syncHeight&&(b.value=r.height),d.value=c(O.x,_.Horizontal),a.value=c(O.y,_.Vertical)};let l;je()&&(l=new ResizeObserver(()=>{e.fixed||w()}),H(()=>e.target,(r,y)=>{k(y)&&(l==null||l.unobserve(y)),k(r)&&(l==null||l.observe(r))},{immediate:!0}));const ge=r=>{r===null||r instanceof HTMLElement?(r!==o.value&&t("update:el",r),o.value=r):t("update:el",null)};H(()=>[e.position,e.target,e.verticalGap,e.horizontalGap,e.syncWidth,e.syncHeight,e.canLeaveViewport],w),ke(()=>{e.syncWidth||(f.value=null),e.syncHeight||(b.value=null)});const T=()=>{e.fixed||w()};ce(()=>{k(e.target)&&w(),o.value&&(l==null||l.observe(o.value)),window.addEventListener("resize",T)}),U(()=>{!k(o.value)||(l==null||l.unobserve(o.value),window.removeEventListener("resize",T))});const Y=R([]);return H(()=>e.target,r=>{for(const y of Y.value)y.removeEventListener("scroll",T);if(k(r)){const y=De(r);for(const h of y)h.addEventListener("scroll",T,{passive:!0});Y.value=y}},{immediate:!0}),n({update:w}),{handleClick:m,handleRef:ge,wowerlayElement:o,positionStyle:u,syncedBoundsStyle:i}},render(){const e=this.tag;return g(e,I({ref:this.handleRef,class:We,style:[this.positionStyle,this.syncedBoundsStyle],onClick:this.handleClick,role:"tooltip"},this.$attrs),{default:()=>{var t,n;return[(n=(t=this.$slots).default)==null?void 0:n.call(t)]}})}});function D(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}const ue=Symbol("key"),ye=$({name:"Wowerlay",inheritAttrs:!1,props:{...me,visible:{required:!0,type:Boolean}},emits:{"update:visible":null,"update:el":null},setup(e,{emit:t,expose:n}){const o=Ee(ue,null),a=R();n({update(){var l;(l=a.value)==null||l.update()}});const d=Oe([]),f=v(!1),b=A(()=>k(e.target)&&e.visible),s=()=>{d.forEach(l=>l())},u=()=>{!e.visible||f.value&&(s(),d.length=0,t("update:visible",!1))};o==null||o.onClose(u);const i=l=>{l.stopPropagation(),s()},m=l=>{l.stopPropagation(),u()};U(u),Se(ue,{onClose(l){d.push(l)}}),ce(()=>{window.addEventListener("click",u)}),U(()=>{window.removeEventListener("click",u)});const c=v(e.visible);return H(()=>e.visible,l=>{l?(setTimeout(()=>{f.value=!0},0),c.value=!0):(f.value=!1,e.transition===!1&&setTimeout(()=>{c.value=!1}))}),{tooltipIsClosable:f,tooltipIsVisible:b,handleWowerlayClick:i,handleContainerClick:m,wowerlayInstance:a,handleContentTransitionEnd:()=>setTimeout(()=>{c.value=!1}),backgroundVisible:c}},render(){let e;const t=this.tooltipIsVisible?g(Ue,I({"onUpdate:el":a=>this.$emit("update:el",a),onClick:this.handleWowerlayClick,ref:"wowerlayInstance"},this.$props,this.$attrs),{default:()=>{var a,d;return[(d=(a=this.$slots).default)==null?void 0:d.call(a)]}}):null;let n=g(J,{appear:!0,enterActiveClass:Me,leaveActiveClass:ze,onAfterLeave:this.handleContentTransitionEnd},D(t)?t:{default:()=>[t]});this.transition===!1?n=t:typeof this.transition=="string"&&(n=g(J,{appear:!0,onAfterLeave:this.handleContentTransitionEnd,name:this.transition},D(t)?t:{default:()=>[t]}));const o=Object.assign(Object.create(null),this.backgroundAttrs);return delete o.key,g(Ce,{to:"body"},D(e=(()=>this.noBackground?n:this.backgroundVisible?g("div",I({class:Ie,onClick:this.handleContainerClick,role:"dialog"},o),[n]):null)())?e:{default:()=>[e]})}}),qe=Ae({elementTag:"button",elementAttrs:{tabindex:0,style:{outline:"none"}}}),ve=["email","password","text","number","url","time","tel"],Re=()=>document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLSelectElement||document.activeElement instanceof HTMLInputElement&&ve.includes(document.activeElement.type),Xe=()=>{var e;return((e=document.activeElement)==null?void 0:e.getAttribute("role"))==="button"||document.activeElement instanceof HTMLButtonElement||document.activeElement instanceof HTMLAnchorElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLSelectElement||document.activeElement instanceof HTMLInputElement&&!ve.includes(document.activeElement.type)},Ye=e=>{const t=[],n=document.scrollingElement||document.documentElement;let o=e.parentNode;for(;o&&o!==n;)(o.offsetHeight<o.scrollHeight||o.offsetWidth<o.scrollWidth)&&t.push({target:o,x:o.scrollLeft,y:o.scrollTop}),o=o.parentNode;return()=>{for(const{target:a,x:d,y:f}of t)a.scrollLeft=d,a.scrollTop=f}},Ke={inheritAttrs:!1},Je=$({...Ke,__name:"ItemRenderer",props:{items:{type:Array,required:!1,default:()=>[]},preventCloseOnSelect:{type:Boolean,required:!1,default:!1},child:{type:Boolean,required:!1,default:!1}},emits:["close","closeSelf"],setup(e,{emit:t}){const n=e,o=v(null),a=v(!1),d=R(),f=v(!1);function b(s){S("esc",()=>t("close")),S("up",s.focusPrevious,{input:!0,repeat:!0,prevent:!0}),S("down",s.focusNext,{input:!0,repeat:!0,prevent:!0}),S("left",i=>{n.child&&(i.preventDefault(),t("closeSelf"))},{input:!0}),S("right",i=>{var c;const m=s.getFocusedItem();m&&Array.isArray((c=m.meta)==null?void 0:c.children)&&(i.preventDefault(),a.value=!0)},{input:!0}),S("enter",i=>{const m=s.getFocusedItemElement();if(document.activeElement===m||Xe()){console.log("blocked");return}s.selectFocusedItem()},{input:!0}),s.onFocus((i,m,c,w)=>{if(o.value=c,d.value=m,f.value=Array.isArray(i==null?void 0:i.children),w&&u(i),Re())c.scrollIntoView({block:"center",inline:"center"});else{const l=Ye(c);c.focus(),w&&l()}});const u=i=>{Array.isArray(i==null?void 0:i.children)&&(a.value=!0)};s.onSelect(i=>{u(i),!n.preventCloseOnSelect&&!i.children&&t("close")}),s.onUnfocus(()=>{o.value=null,d.value=void 0,a.value=!1}),s.onDOMFocus((i,m,c)=>{s.setFocusByKey(c.key)})}return(s,u)=>(L(),de(fe,null,[g(C(He),I(s.$attrs,{setup:b,items:n.items,itemDefaults:C(qe)}),{render:q(({meta:i})=>[_e(Te(i.text)+" ",1),i.children?(L(),Q(C(Le),{key:0,style:{transform:"translateX(50%)","margin-left":"auto","font-size":"10px"}})):Z("v-if",!0)]),_:1},16,["items","itemDefaults"]),f.value?(L(),Q(C(ye),{key:0,target:o.value,visible:a.value,"onUpdate:visible":u[2]||(u[2]=i=>a.value=i),noBackground:"",position:"right-start",horizontalGap:-3,transition:!1},{default:q(()=>[g(pe,{child:"",onCloseSelf:u[0]||(u[0]=i=>a.value=!1),items:C(d).meta.children,onClose:u[1]||(u[1]=()=>{a.value=!1,s.$emit("close")})},null,8,["items"])]),_:1},8,["target","visible"])):Z("v-if",!0)],64))}}),pe=he(Je,[["__file","/home/runner/work/vue-selectable-items/vue-selectable-items/playground/examples/nested/ItemRenderer.vue"]]),Qe=E("p",{style:{"margin-bottom":"20px",color:"var(--txt-2)"}}," Navigate with ArrowUp and ArrowDown and select with Enter ",-1),Ze=E("div",{style:{"text-align":"center"}},[E("input",{class:"input",type:"text",placeholder:"test-input"}),E("button",{style:{"margin-left":"10px"},class:"btn"}," Clicko ")],-1),et=E("br",null,null,-1),tt=E("br",null,null,-1),nt=$({__name:"index",setup(e){const t=[p({meta:{text:"Washington"},key:"washington"}),p({meta:{text:"New York City",children:[p({meta:{text:"Disabled one"},key:"inner-0",disabled:!0}),p({key:"inner-1",disabled:!0,meta:{text:"Momentos",children:[p({meta:{text:"Momentos"},key:"inner-0"}),p({meta:{text:"Momentos"},key:"inner-1"}),p({meta:{text:"Momentos"},key:"inner-2"})]}}),p({meta:{text:"Momentos"},key:"inner-2"})]},key:"nwc"}),p({meta:{text:"Istanbul"},key:"Istanbul"}),p({meta:{text:"BMW"},key:"bmw",onSelect:()=>console.log("Brem\u0131n how are you")})],n=v();return(o,a)=>(L(),de(fe,null,[Qe,Ze,et,tt,E("div",{ref_key:"target",ref:n},null,512),g(C(ye),{noBackground:"",visible:!0,position:"bottom",target:n.value,transition:!1},{default:q(()=>[g(pe,{items:t})]),_:1},8,["target"])],64))}}),st=he(nt,[["__file","/home/runner/work/vue-selectable-items/vue-selectable-items/playground/examples/nested/index.vue"]]);export{st as default};
